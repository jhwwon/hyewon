-- 집계(통계) 함수(ex) 레코드(행) 수(count), 레코드 값들의 합계(sum), 평균(avg), 최대값(max), ...)
-- group by(옵션), having(옵션)

-- 레코드 행 수 가져오는 함수(count)
SELECT count(*) FROM employees;

-- EMPLOYEE_ID의 컬럼 값이 있는 행의 개수(107개)
SELECT count(EMPLOYEE_ID) FROM employees;

-- DEPARTMENT_ID의 컬럼 값이 있는 행의 개수(106개)
SELECT count(DEPARTMENT_ID) FROM employees;

SELECT * FROM EMPLOYEES;

-- department_id의 값이 별개인 것한 행의 개수로 포함하여 값을 반환(11개)
SELECT count(DISTINCT department_id) FROM EMPLOYEES;

SELECT DISTINCT department_id FROM EMPLOYEES;

SELECT count(*) FROM CUSTOMERS;

SELECT * FROM customers;

SELECT count(DISTINCT cust_year_of_birth) FROM CUSTOMERS;

-- sum함수(컬럼의 값이 숫자인 경우에 한해서 사용)
SELECT round(sum(salary) / count(EMPLOYEE_ID)) FROM EMPLOYEES;

SELECT sum(salary), sum(DISTINCT salary) AS distinct_salary FROM EMPLOYEES;

-- avg함수(평균), min(최소값), max(최대값), variance(분산), stddev(표준편차)

-- group by절 사용(원하는 그룹을 가져고 올 때 사용)
select department_id, sum(salary)
  FROM EMPLOYEES
  WHERE demparment_id IN (10, 20, 30)
  GROUP BY DEPARTMENT_ID
  ORDER BY DEPARTMENT_ID
;

SELECT DEPARTMENT_ID, salary 
  FROM EMPLOYEES
 ORDER BY DEPARTMENT_ID
;

SELECT * 
  FROM kor_loan_status
;

CREATE TABLE "KOR_LOAN_STATUS" (	
	"PERIOD" VARCHAR2(6), 
	"REGION" VARCHAR2(10), 
	"GUBUN" VARCHAR2(30), 
	"LOAN_JAN_AMT" NUMBER
);

INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','광주','기타대출',15490.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','광주','기타대출',15709.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','대전','기타대출',16360.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','대전','기타대출',16722.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','대전','기타대출',17225.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','대전','기타대출',17347.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','대전','기타대출',17502.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','대전','기타대출',18559);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','대전','기타대출',18833.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','울산','기타대출',11007.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','울산','기타대출',11130);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','울산','기타대출',12156.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','울산','기타대출',12262.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','울산','기타대출',12376.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','울산','기타대출',13193.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','울산','기타대출',13336.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','경기','기타대출',167394.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','경기','기타대출',168444.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','경기','기타대출',170357.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','경기','기타대출',170191.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','경기','기타대출',171441.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','경기','기타대출',172518.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','경기','기타대출',173416.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','강원','기타대출',11502.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','강원','기타대출',11677.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','강원','기타대출',12025.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','강원','기타대출',12093.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','강원','기타대출',12366.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','강원','기타대출',12778.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','강원','기타대출',12893.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','충북','기타대출',11642.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','충북','기타대출',11862);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','충북','기타대출',12598.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','충북','기타대출',12726.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','충북','기타대출',13089.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','충북','기타대출',13691.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','충북','기타대출',13830.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','충남','기타대출',21994.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','충남','기타대출',22197.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','충남','기타대출',21429.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','충남','기타대출',21488.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','충남','기타대출',21813.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','충남','기타대출',22402.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','충남','기타대출',22602.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','전북','기타대출',14725.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','전북','기타대출',14972.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','전북','기타대출',15685.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','전북','기타대출',15802.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','전북','기타대출',16153.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','전북','기타대출',17096.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','전북','기타대출',17285.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','전남','기타대출',12274.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','전남','기타대출',12441.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','전남','기타대출',12921.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','전남','기타대출',13069.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','전남','기타대출',13255.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','전남','기타대출',13858.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','전남','기타대출',14016.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','경북','기타대출',18616.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','경북','기타대출',18912.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','경북','기타대출',19667);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','경북','기타대출',19850);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','경북','기타대출',20232.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','경북','기타대출',21706.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','경북','기타대출',22060.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','경남','기타대출',29389.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','경남','기타대출',29904.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','경남','기타대출',32289.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','경남','기타대출',32680);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','경남','기타대출',33579.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','경남','기타대출',36254.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','경남','기타대출',36746.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','제주','기타대출',4500);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','제주','기타대출',4611);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','제주','기타대출',4615.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','제주','기타대출',4667.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','제주','기타대출',4818.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','제주','기타대출',5142.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','제주','기타대출',5209.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','세종','기타대출',0);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','세종','기타대출',0);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','세종','기타대출',1655.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','세종','기타대출',1766.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','세종','기타대출',1814.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','세종','기타대출',2583.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','세종','기타대출',2653.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','서울','주택담보대출',130105.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','서울','주택담보대출',130452.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','서울','주택담보대출',128097.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','서울','주택담보대출',127706.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','서울','주택담보대출',128227.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','서울','주택담보대출',128066.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','서울','주택담보대출',128418.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','부산','주택담보대출',23936.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','부산','주택담보대출',24328.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','부산','주택담보대출',26128.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','부산','주택담보대출',26137.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','부산','주택담보대출',26795.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','부산','주택담보대출',28422);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','부산','주택담보대출',28794.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','대구','주택담보대출',14043.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','대구','주택담보대출',14229);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','대구','주택담보대출',15154.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','대구','주택담보대출',15260.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','대구','주택담보대출',15684.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','대구','주택담보대출',16821.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','대구','주택담보대출',17043.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','인천','주택담보대출',29724.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','인천','주택담보대출',29871.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','인천','주택담보대출',30130.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','인천','주택담보대출',30064.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','인천','주택담보대출',30237.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','인천','주택담보대출',29355.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','인천','주택담보대출',29478.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','광주','주택담보대출',8731.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','광주','주택담보대출',8964.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','광주','주택담보대출',9461.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','광주','주택담보대출',9458.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','광주','주택담보대출',9596.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','광주','주택담보대출',9931);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','광주','주택담보대출',10062.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','대전','주택담보대출',10394.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','대전','주택담보대출',10733.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','대전','주택담보대출',11169.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','대전','주택담보대출',11210);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','대전','주택담보대출',11349.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','대전','주택담보대출',12126);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','대전','주택담보대출',12285.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','울산','주택담보대출',6517);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','울산','주택담보대출',6627.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','울산','주택담보대출',7340.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','울산','주택담보대출',7385.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','울산','주택담보대출',7540.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','울산','주택담보대출',8065.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','울산','주택담보대출',8152.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','경기','주택담보대출',108188.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','경기','주택담보대출',109028.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','경기','주택담보대출',109371.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','경기','주택담보대출',108928);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','경기','주택담보대출',110059.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','경기','주택담보대출',108957.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','경기','주택담보대출',109400);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','강원','주택담보대출',4627.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','강원','주택담보대출',4683.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','강원','주택담보대출',4945.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','강원','주택담보대출',4951.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','강원','주택담보대출',5083.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','강원','주택담보대출',5411.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','강원','주택담보대출',5459.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','충북','주택담보대출',5649.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','충북','주택담보대출',5784.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','충북','주택담보대출',6055);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','충북','주택담보대출',6123.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','충북','주택담보대출',6393.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','충북','주택담보대출',6635.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','충북','주택담보대출',6698.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','충남','주택담보대출',9601.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','충남','주택담보대출',9710.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','충남','주택담보대출',9422.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','충남','주택담보대출',9444.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','충남','주택담보대출',9618.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','충남','주택담보대출',9934.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','충남','주택담보대출',10067.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','전북','주택담보대출',7274.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','전북','주택담보대출',7447.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','전북','주택담보대출',7931.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','전북','주택담보대출',7959.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','전북','주택담보대출',8190.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','전북','주택담보대출',8665.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','전북','주택담보대출',8775.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','전남','주택담보대출',5220.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','전남','주택담보대출',5327.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','전남','주택담보대출',5722.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','전남','주택담보대출',5808.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','전남','주택담보대출',5925.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','전남','주택담보대출',6227.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','전남','주택담보대출',6296.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','경북','주택담보대출',8162.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','경북','주택담보대출',8277.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','경북','주택담보대출',8665);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','경북','주택담보대출',8680.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','경북','주택담보대출',8907.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','경북','주택담보대출',9684.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','경북','주택담보대출',9862);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','경남','주택담보대출',14695.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','경남','주택담보대출',15062.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','경남','주택담보대출',16985.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','경남','주택담보대출',17168.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','경남','주택담보대출',17789.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','경남','주택담보대출',19560.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','경남','주택담보대출',19809.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','제주','주택담보대출',1420.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','제주','주택담보대출',1477.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','제주','주택담보대출',1659.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','제주','주택담보대출',1683.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','제주','주택담보대출',1767.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','제주','주택담보대출',1993.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','제주','주택담보대출',2021.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','세종','주택담보대출',0);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','세종','주택담보대출',0);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','세종','주택담보대출',907.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','세종','주택담보대출',1002.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','세종','주택담보대출',1018.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','세종','주택담보대출',1557.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','세종','주택담보대출',1611.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','서울','기타대출',204102.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','서울','기타대출',204275.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','서울','기타대출',202557.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','서울','기타대출',202887.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','서울','기타대출',203344.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','서울','기타대출',204918.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','서울','기타대출',205644.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','부산','기타대출',35163.1);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','부산','기타대출',35570.6);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','부산','기타대출',37191.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','부산','기타대출',37286);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','부산','기타대출',38040.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','부산','기타대출',39979.4);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','부산','기타대출',40463.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','대구','기타대출',21882.3);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','대구','기타대출',22117.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','대구','기타대출',23195);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','대구','기타대출',23366);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','대구','기타대출',23966);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','대구','기타대출',25462.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','대구','기타대출',25769.5);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','인천','기타대출',40404.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','인천','기타대출',40556.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','인천','기타대출',40916.8);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','인천','기타대출',40895.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','인천','기타대출',41106);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201310','인천','기타대출',40440.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201311','인천','기타대출',40650.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201111','광주','기타대출',13900.7);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201112','광주','기타대출',14209.9);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201210','광주','기타대출',14645);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201211','광주','기타대출',14720.2);
INSERT INTO KOR_LOAN_STATUS (PERIOD,REGION,GUBUN,LOAN_JAN_AMT) VALUES ('201212','광주','기타대출',14956.4);
   
SELECT * FROM kor_loan_status;

-- 기간(2013년 각월) 및 지역별 대출 총합 금액 조회
SELECT period, region, sum(loan_jan_amt) totl_jan
  FROM kor_loan_status
 WHERE period LIKE '2013%'
 GROUP BY period, region
 ORDER BY period, region
;

-- 2013년 11월의 대출 총합 금액
SELECT '201311' AS 기간, region, sum(loan_jan_amt) totl_jan
  FROM kor_loan_status
 WHERE period = '201311'
  GROUP BY region
  ORDER BY region
;

SELECT period, region, sum(loan_jan_amt) totl_jan
  FROM kor_loan_status
 WHERE period = '201311'
 GROUP BY period, region
 ORDER BY period, region
;

-- having절(group by에 대한 조건절)
SELECT period, region, sum(loan_jan_amt) totl_jan
  FROM kor_loan_status
 WHERE period = '201311'
 GROUP BY period, region
 HAVING sum(loan_jan_amt) >= 20000
 ORDER BY period, region
;

-- 문제 1: 각 지역(REGION)별로 대출 건수를 출력하세요
-- 예상출력: REGION, COUNT~
SELECT region, count(region) AS loan_count
  FROM KOR_LOAN_STATUS
 GROUP BY region
;
 
-- 문제 2: 201311 기간에 지역별(REGION) 총 대출 금액(LOAN_JAN_AMT)을 구하세요.
-- 예상 출력: REGION, 총 대출 금액
SELECT region, sum(LOAN_JAN_AMT) AS loan_sum
  FROM KOR_LOAN_STATUS
 WHERE period = '201311'
  GROUP BY region
;
  
-- 문제 3: 기타대출에 대해 기간(PERIOD)별 전체 대출 총액을 구하세요. 단, 총액이 200,000 이상인 기간만 출력하세요.
--   조건: GUBUN = '기타대출'
--   조건: 총액 > 200000 (HAVING 사용)
SELECT period, sum(LOAN_JAN_AMT) AS loan_sum
  FROM KOR_LOAN_STATUS
 WHERE gubun = '기타대출'
  GROUP BY period
 HAVING sum(LOAN_JAN_AMT) > 200000
;

-- 문제 4: 지역별(REGION)과 대출 구분(GUBUN)별 평균 대출 금액을 구하세요.
--   단, 평균이 100,000 이상인 조합만 출력하세요.
--     예상 출력: REGION, GUBUN, AVG(LOAN_JAN_AMT)
--     HAVING 사용
SELECT region, gubun, avg(LOAN_JAN_AMT) AS loan_avg
  FROM KOR_LOAN_STATUS
  GROUP BY region, gubun
 HAVING avg(LOAN_JAN_AMT) >= 100000
;

-- 문제 5: 각 지역(REGION)별로 기타대출의 평균 대출 금액이 가장 높은 상위 3개 지역을 구하세요.
--   WHERE GUBUN = '기타대출'
--   ORDER BY AVG(LOAN_JAN_AMT) DESC
--   ROWNUM 사용
SELECT a.region, round(a.loan_avg)
FROM (
	SELECT region, avg(loan_jan_amt) AS loan_avg
	  FROM KOR_LOAN_STATUS
	 WHERE gubun = '기타대출'
	 GROUP BY region
	-- FETCH FIRST 3 ROWS ONLY
	 ORDER BY avg(loan_jan_amt) DESC
) a
WHERE ROWNUM <= 3 
--ORDER BY AVG(LOAN_JAN_AMT) DESC
--ORDER BY a.loan_avg DESC
;


-- 문제 6: 2013년(PERIOD가 '2013%'로 시작)에 대출이 발생한 지역들 중,
-- 기타대출과 주택담보대출의 평균 대출 금액이 모두 20,000 이상인 지역만 출력하세요.
--   GROUP BY REGION, GUBUN
--   조건: PERIOD LIKE '2013%'
--   두 GUBUN의 조건을 동시에 만족하는 REGION
--   힌트: 집계함수 CASE 사용
SELECT region
  FROM KOR_LOAN_STATUS
 WHERE PERIOD LIKE '2013%'
 GROUP BY region
 HAVING sum(CASE WHEN gubun = '기타대출' THEN LOAN_JAN_AMT ELSE 0 END) 
 			/ count(CASE WHEN gubun = '기타대출' THEN period END) >= 20000
 	AND sum(CASE WHEN gubun = '주택담보대출' THEN LOAN_JAN_AMT ELSE 0 END)
 	        / count(CASE WHEN gubun = '주택담보대출' THEN period END) >= 20000
;
